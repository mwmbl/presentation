<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Mwmbl: how to build a search engine with (almost) no money</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
	<!-- <section>Slide 1</section> -->
	<!-- <section>Slide 2</section> -->
	<section>
	  <h1>How to build a search engine with (almost) no money</h1>
<br>

<h3>Daoud Clarke</h3>

<br>
OSSym24 - 10th October 2024
	</section>

	<section>
	  <img class="stretch" src="img/finances.png">
	</section>
	<section>
	  <h3>Part 1: technology</h3>
	</section>

	<section>
	  <img class="stretch" src="img/latency-1.png">
	</section>
	<section>
	  <img class="stretch" src="img/latency-2.png">
	</section>
	<section>
	  <img class="stretch" src="img/latency-3.png">
	</section>
	<section>
	  <img class="stretch" src="img/latency-4.png">
	</section>
	<section>
	  <h3>A traditional inverted index is costly</h3>
	</section>

	<section>
	  <img class="stretch" src="img/inverted-index.png">
	</section>
	
	<section>
	  <h3>We need a new architecture</h3>
	</section>

	<section data-background-size="contain" data-background-image="img/tiny-storage.svg" data-background-color="white"></section>

	<section>
	  <h3>Part 2: community</h3>
	</section>

	<section data-background-image="img/stats0.png" data-background-size="contain">
	</section>

	<section>
	  <img class="stretch" src="img/contributions.png">
	</section>

	
	<section>
	  <pre><code data-trim data-noescape class="stretch">
def get_key_page_index(self, key) -> int:
    key_hash = mmh3.hash(key, signed=False)
    return key_hash % self.num_pages
	  </code></pre>
	  <span>"apple" => 1680</span>
	</section>

	<section>
	  <pre><code data-trim data-noescape class="stretch">
def _get_page_tuples(self, i):
    page_data = self.mmap[
        i * self.page_size +
        METADATA_SIZE:(i + 1) * self.page_size
        + METADATA_SIZE]
    try:
        decompressed_data = self.decompressor.decompress(
            page_data)
    except ZstdError:
        logger.exception(f"Error decompressing: {page_data}")
        return []
    return json.loads(decompressed_data.decode('utf8'))
	  </code></pre>
	</section>

	<section data-background-size="contain" data-background-image="img/page.png" data-background-color="#300a24"></section>
	<section data-background-size="contain" data-background-image="img/page-2.png" data-background-color="#300a24"></section>

	<section>
	  <ul>
	    <li> Query: "open broadcaster software"
	    <li> Look up:
	      <ul>
		<li> open
		<li> broadcaster
		<li> software
		<li> open broadcaster
		<li> broadcaster software
	      </ul>
	  </ul>
	</section>

	<section>
	  <h3>What is the maximum number of reads?</h3>
	</section>

	<section>
	  <h3>Will it work?</h3>
	</section>

	<section>
	  <ul>
	    <li> We fit around 23 results in one page of 4096 bytes
	    <li> Google indexes around 100 billion pages per locale
	    <li> We would need an index of around 16 terabytes
	  </ul>
	</section>	

	<section>
	  <h3>How can we reduce crawling costs?</h3>
	</section>

	<section>
	  <pre><code data-trim data-noescape class="stretch">
@router.post('/batches/new')
def request_new_batch(batch_request: NewBatchRequest) \
    -> list[str]:
    ...

@router.post('/batches/')
def post_batch(batch: Batch):
    ...
	  </code></pre>
	</section>
	
	<section>
	  <h3>Will it work?</h3>
	</section>

	<section>
	  <ul>
	    <li> We are currently crawling around 1 million pages a day
	    <li> We currently have about 26 active volunteers
	    <li> We want our index of 100 billion pages to be refreshed at least once a month
	    <li> We need to crawl around 3 billion pages a day
	  </ul>
	</section>	

	<section>
	  <h3>But will it work?</h3>
	</section>
	
	<section>
	  <h3>How to fly (or build a search engine)</h3>
	  <i style="font-style: italic !important">Do not listen to what anybody says to you at this point because they are unlikely to say anything helpful. They are most likely to say something along the lines of "Good God, you can't possibly be flying!"</i>
	  <br><br>
	  <span style="color: red"><i style="font-style: italic !important">It is vitally important not to believe them or they will suddenly be right.</i> </span>
	  <br><br>
	  - Douglas Adams
	</section>
	
	<section data-background-image="img/larry-page.png">
	  <h3>Why should the gateway to the world's knowledge be in the hands of a corporation?</h3>
	</section>
	
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
	  hash: true,

	  // Learn about plugins: https://revealjs.com/plugins/
	  plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
      });
    </script>
  </body>
</html>
